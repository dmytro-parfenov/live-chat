function initMap(e,t){var a=new google.maps.Map(document.getElementById("map"),{zoom:2,minZoom:2,center:{lat:0,lng:0},mapTypeControl:!1}),r=e.map(function(e,a){return new google.maps.Marker({position:e,title:t[a]})});new MarkerClusterer(a,r,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}function uniqueCountries(e){var t=[];e:for(var a=0;a<e.length;a++){for(var r=e[a],o=0;o<t.length;o++)if(t[o]==r)continue e;t.push(r)}return t}function drawMapStatistic(e,t,a){function r(){var r=google.visualization.arrayToDataTable(t),o={title:e},n=new google.visualization.BarChart(document.getElementById(a));n.draw(r,o)}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(r)}$(document).ready(function(){$.ajax({type:"GET",url:"/master/messages-map/coords",success:function(e){if(e.length>0){for(var t=[],a=[],r=[],o=0;o<e.length;o++)t.push({lat:parseFloat(e[o].user_location_lat),lng:parseFloat(e[o].user_location_lng)}),$.ajax({async:!1,type:"GET",url:"https://maps.googleapis.com/maps/api/geocode/json",data:{latlng:e[o].user_location_lat+","+e[o].user_location_lng,language:"en",result_type:"street_address|country",key:"AIzaSyAIpi0wvFb7yyxMzJZWXYxX3cEQn_byngU"},success:function(e){e.results.length>0?e.results.length>1?(a.push(e.results[0].formatted_address),r.push(e.results[1].formatted_address)):(a.push(e.results[0].formatted_address),r.push(e.results[0].formatted_address)):(a.push("Not found"),r.push("Not found"))}});initMap(t,a),originalArrayCountries=r,uniqueArrayCountries=uniqueCountries(r);var n=[["Name","Value"]];for(o=0;o<uniqueArrayCountries.length;o++){var s=0;for(k=0;k<originalArrayCountries.length;k++)uniqueArrayCountries[o]===originalArrayCountries[k]&&s++;n.push([uniqueArrayCountries[o],s])}drawMapStatistic("Countries statistics",n,"barchart-map")}}})}),$(window).on("load",function(){});