function soundNotification(o){var e=new Audio;e.src=o,e.autoplay=!0}function sendNotification(o,e){function n(){window.focus(),$("html, body").animate({scrollTop:$(document).height()},500),this.close()}if("granted"===Notification.permission){var a=new Notification(o,e);a.onclick=n}else"denied"!==Notification.permission&&Notification.requestPermission(function(a){if("granted"===a){var t=new Notification(o,e);t.onclick=n}})}function windowScroll(o,e){var n=o;e&&(o=0),$("html, body").animate({scrollTop:o},500,function(){e||(n=$(window).scrollTop()),showToolPannel=!1;var o=!0;$(window).scroll(function(){coordWindowTop=$(window).scrollTop(),n-70>coordWindowTop&&!showToolPannel&&"block"!==$(".search-form").css("display")?($(".tool-pannel").stop(),$(".tool-pannel").animate({right:"0"},500),showToolPannel=!0):n-70<coordWindowTop&&showToolPannel&&($(".tool-pannel").stop(),$(".tool-pannel").animate({right:"-50px"},500),showToolPannel=!1),coordWindowTop>=n-70&&!o?($(".send-message-container").stop(),$(".send-message-container").animate({bottom:"0"},500),o=!0):coordWindowTop<n-70&&o&&($(".send-message-container").stop(),$(".send-message-container").animate({bottom:"-70px"},500),o=!1)})})}$(document).ready(function(){windowScroll($(document).height()),$("body").on("click",".map-marker",function(){var o=parseFloat($(this).attr("data-user-location-lat")),e=parseFloat($(this).attr("data-user-location-lng")),n={lat:o,lng:e};mapObjectLocation=$("#map-object-location")[0];var a=new google.maps.Map(mapObjectLocation,{zoom:14,center:n});$.ajax({type:"GET",url:"https://maps.googleapis.com/maps/api/geocode/json",data:{latlng:o+","+e,language:"en",key:"AIzaSyAIpi0wvFb7yyxMzJZWXYxX3cEQn_byngU"},success:function(o){var e='<div id="content-map-marker">'+o.results[0].formatted_address+"</div>",t=new google.maps.InfoWindow({content:e}),i=new google.maps.Marker({position:n,map:a});google.maps.event.addListener(i,"click",function(){t.open(a,i)})}}),$(".background-map-object, #map-object").stop(),$(".background-map-object, #map-object").fadeIn(500),google.maps.event.trigger(a,"resize");var t=new google.maps.LatLng(o,e);a.setCenter(t)}),$(".background-map-object").click(function(){$(".background-map-object, #map-object").stop(),$(".background-map-object, #map-object").fadeOut(500)}),$(".show-earlier span").click(function(){var o=$(this).attr("data-first-message"),e=$(this).prev().val();$.ajax({type:"POST",url:"/show-more-messages",dataType:"json",data:{_token:e,first_message:o},success:function(o){$(".message-block").first().before(o.html),$(".message-block").hide(),$(".message-block").fadeIn(500),windowScroll($(document).height(),!0),$(".show-earlier span").attr("data-first-message",o.first_message)},error:function(){$(".show-earlier").slideUp(500)}})}),$(".search-result-again span").click(function(){$(".search").click()})}),$(window).on("load",function(){"Notification"in window?Notification.requestPermission():console.log("Your browser does not support HTML5 Notifications");var o=new Pusher("5ccc3f2a7680d594a7dc",{encrypted:!0}),e=o.subscribe("new-message-channel");e.bind("new-message-event",function(o){$("html, body").animate({scrollTop:$(document).height()},500),$(".message-block").last().after(o.html),$(".message-block").last().hide(),$(".message-block").last().fadeIn(500),document.hidden&&(soundNotification("frontend/sounds/get-message.wav"),sendNotification(o.user_name,{body:o.message,icon:"favicon.ico",dir:"auto"}))});var n=o.subscribe("new-user-channel");n.bind("new-user-event",function(o){soundNotification("frontend/sounds/get-message.wav"),sendNotification("New user connected",{body:o,icon:"favicon.ico",dir:"auto"})})});