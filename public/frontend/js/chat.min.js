function soundNotification(o){var e=new Audio;e.src=o,e.autoplay=!0}function sendNotification(o,e){function a(){window.focus(),$("html, body").animate({scrollTop:$(document).height()},500),this.close()}if("granted"===Notification.permission){var t=new Notification(o,e);t.onclick=a}else"denied"!==Notification.permission&&Notification.requestPermission(function(t){if("granted"===t){var n=new Notification(o,e);n.onclick=a}})}$(document).ready(function(){$("body").on("click",".map-marker",function(){locationLat=parseFloat($(this).attr("data-user-location-lat")),locationLng=parseFloat($(this).attr("data-user-location-lng"));var o={lat:locationLat,lng:locationLng};mapObjectLocation=$("#map-object-location")[0];var e=new google.maps.Map(mapObjectLocation,{zoom:14,center:o});$.ajax({type:"GET",url:"https://maps.googleapis.com/maps/api/geocode/json",data:{latlng:locationLat+","+locationLng,language:"en",key:"AIzaSyAIpi0wvFb7yyxMzJZWXYxX3cEQn_byngU"},success:function(a){var t='<div id="content-map-marker">'+a.results[0].formatted_address+"</div>",n=new google.maps.InfoWindow({content:t}),i=new google.maps.Marker({position:o,map:e});google.maps.event.addListener(i,"click",function(){n.open(e,i)})}}),$(".background-map-object, #map-object").stop(),$(".background-map-object, #map-object").fadeIn(500),google.maps.event.trigger(e,"resize");var a=new google.maps.LatLng(locationLat,locationLng);e.setCenter(a)}),$(".background-map-object").click(function(){$(".background-map-object, #map-object").stop(),$(".background-map-object, #map-object").fadeOut(500)}),$(".show-earlier span").click(function(){first_message=$(this).attr("data-first-message"),_token=$(this).prev().val(),$.ajax({type:"POST",url:"/show-more-messages",dataType:"json",data:{_token:_token,first_message:first_message},success:function(o){$(".message-block").first().before(o.html),$(".message-block").hide(),$(".message-block").fadeIn(500),$(".show-earlier span").attr("data-first-message",o.first_message)},error:function(){$(".show-earlier").slideUp(500)}})})}),$(window).on("load",function(){"Notification"in window?Notification.requestPermission():console.log("Your browser does not support HTML5 Notifications");var o=new Pusher("5ccc3f2a7680d594a7dc",{encrypted:!0}),e=o.subscribe("new-message-channel");e.bind("new-message-event",function(o){$("html, body").animate({scrollTop:$(document).height()},500),$(".message-block").last().after(o.html),$(".message-block").last().hide(),$(".message-block").last().fadeIn(500),document.hidden&&(soundNotification("frontend/sounds/get-message.wav"),sendNotification(o.user_name,{body:o.message,icon:"favicon.ico",dir:"auto"}))});var a=o.subscribe("new-user-channel");a.bind("new-user-event",function(o){soundNotification("frontend/sounds/get-message.wav"),sendNotification("New user connected",{body:o,icon:"favicon.ico",dir:"auto"})})});